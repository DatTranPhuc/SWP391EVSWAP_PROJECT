<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EV SWAP Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/dashboard.css}" href="/css/dashboard.css">
</head>
<body class="dashboard-body">
<div class="background-gradient"></div>
<div class="background-glow"></div>

<header class="top-nav">
    <div class="container nav-inner">
        <div class="brand">
            <span class="brand-icon">üì∫</span>
            <span class="brand-name">EV SWAP</span>
        </div>
        <nav class="nav-links" aria-label="ƒêi·ªÅu h∆∞·ªõng ch√≠nh">
            <a href="#overview">T·ªïng quan</a>
            <a href="#benefits">Ph∆∞∆°ng ti·ªán</a>
            <a href="#stations">T√¨m tr·∫°m</a>
            <a href="#reports">B√°o c√°o</a>
            <a href="#account">T√†i kho·∫£n</a>
            <a href="#support">H·ªó tr·ª£</a>
        </nav>
        <div class="auth-area" th:if="${loggedIn}">
            <span class="welcome">Xin ch√†o, <strong th:text="${driverName}">ng∆∞·ªùi d√πng</strong>!</span>
            <form th:action="@{/logout}" method="post">
                <button class="btn ghost" type="submit">ƒêƒÉng xu·∫•t</button>
            </form>
        </div>
        <div class="auth-area" th:if="${!loggedIn}">
            <a class="btn ghost" th:href="@{/login}">ƒêƒÉng nh·∫≠p</a>
            <a class="btn primary" th:href="@{/register}">ƒêƒÉng k√Ω</a>
        </div>
    </div>
</header>

<main>
    <div class="container">
        <p class="alert" th:if="${loginSuccess}" th:text="${loginSuccess}"></p>
    </div>

    <section id="overview" class="hero-section container">
        <div class="hero-content">
            <p class="hero-subtitle">T∆∞∆°ng lai xanh cho Vi·ªát Nam</p>
            <h1 class="hero-title">ƒê·ªïi pin xe ƒëi·ªán <span>ch·ªâ trong 3 ph√∫t</span></h1>
            <p class="hero-description"
               th:text="'M·∫°ng l∆∞·ªõi ' + stats.activeStations + '/' + stats.totalStations + ' tr·∫°m ho·∫°t ƒë·ªông c√πng ' + stats.activeStaff + ' nh√¢n s·ª± h·ªó tr·ª£ 24/7. Tr·∫£i nghi·ªám t∆∞∆°ng lai di chuy·ªÉn xanh ngay h√¥m nay.'">
                H·ªá th·ªëng ƒë·ªïi pin th√¥ng minh v·ªõi c√¥ng ngh·ªá ti√™n ti·∫øn, tr·∫°m r·ªông kh·∫Øp v√† ƒë·ªôi ng≈© h·ªó tr·ª£ nhanh ch√≥ng. Tr·∫£i nghi·ªám t∆∞∆°ng lai di chuy·ªÉn xanh ngay h√¥m nay.
            </p>
            <div class="hero-cta">
                <a th:href="@{/register}" class="btn primary">ƒêƒÉng k√Ω ngay</a>
                <a th:href="@{/login}" class="btn outline">ƒê√£ c√≥ t√†i kho·∫£n</a>
            </div>
            <div class="hero-actions" th:if="${loggedIn}">
                <div class="action-buttons">
                    <form th:action="@{/dashboard/action}" method="post">
                        <button class="nav-button" type="submit" name="feature" value="T·ªïng quan">T·ªïng quan</button>
                    </form>
                    <form th:action="@{/dashboard/action}" method="post">
                        <button class="nav-button" type="submit" name="feature" value="Ph∆∞∆°ng ti·ªán">Ph∆∞∆°ng ti·ªán</button>
                    </form>
                    <form th:action="@{/dashboard/action}" method="post">
                        <button class="nav-button" type="submit" name="feature" value="T√¨m tr·∫°m">T√¨m tr·∫°m</button>
                    </form>
                    <form th:action="@{/dashboard/action}" method="post">
                        <button class="nav-button" type="submit" name="feature" value="B√°o c√°o">B√°o c√°o</button>
                    </form>
                    <form th:action="@{/dashboard/action}" method="post">
                        <button class="nav-button" type="submit" name="feature" value="T√†i kho·∫£n">T√†i kho·∫£n</button>
                    </form>
                    <form th:action="@{/dashboard/action}" method="post">
                        <button class="nav-button" type="submit" name="feature" value="H·ªó tr·ª£">H·ªó tr·ª£</button>
                    </form>
                </div>
            </div>
            <div class="hero-actions locked" th:if="${!loggedIn}">
                <div class="action-buttons">
                    <button type="button" class="nav-button locked" onclick="openLoginModal()">T·ªïng quan</button>
                    <button type="button" class="nav-button locked" onclick="openLoginModal()">Ph∆∞∆°ng ti·ªán</button>
                    <button type="button" class="nav-button locked" onclick="openLoginModal()">T√¨m tr·∫°m</button>
                    <button type="button" class="nav-button locked" onclick="openLoginModal()">B√°o c√°o</button>
                    <button type="button" class="nav-button locked" onclick="openLoginModal()">T√†i kho·∫£n</button>
                    <button type="button" class="nav-button locked" onclick="openLoginModal()">H·ªó tr·ª£</button>
                </div>
            </div>
        </div>
        <div class="hero-card">
            <div class="card-icon">üì∫</div>
            <div class="card-metric">
                <span class="metric-label">Tr·∫°m ƒëang ho·∫°t ƒë·ªông</span>
                <span class="metric-value">
                    <strong th:text="${stats.activeStations}">0</strong>
                    <span class="metric-subvalue">/</span>
                    <span class="metric-subvalue" th:text="${stats.totalStations}">0</span>
                </span>
            </div>
            <div class="card-metric">
                <span class="metric-label">Ph∆∞∆°ng ti·ªán c·ªßa b·∫°n</span>
                <span class="metric-value">
                    <span th:if="${loggedIn}" th:text="${vehicleCount} + ' xe'">0 xe</span>
                    <span th:if="${!loggedIn}">ƒêƒÉng nh·∫≠p ƒë·ªÉ xem</span>
                </span>
            </div>
            <div class="card-rating">
                <span class="metric-label">Nh√¢n s·ª± h·ªó tr·ª£</span>
                <div class="rating-value" th:text="${stats.activeStaff + ' nh√¢n vi√™n'}">0 nh√¢n vi√™n</div>
            </div>
        </div>
    </section>

    <section class="stats-section container">
        <div class="stat-card">
            <div class="stat-value" th:text="${stats.totalDrivers}">0</div>
            <div class="stat-label">T√†i x·∫ø ƒë√£ ƒëƒÉng k√Ω</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" th:text="${stats.totalVehicles}">0</div>
            <div class="stat-label">Ph∆∞∆°ng ti·ªán ƒë∆∞·ª£c qu·∫£n l√Ω</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" th:text="${stats.totalStations}">0</div>
            <div class="stat-label">T·ªïng s·ªë tr·∫°m</div>
        </div>
    </section>

    <section id="benefits" class="feature-section container">
        <div class="section-header">
            <span class="section-badge">T√≠nh nƒÉng</span>
            <h2 class="section-title">T·∫°i sao ch·ªçn EV SWAP?</h2>
            <p class="section-description"
               th:text="'ƒê∆∞·ª£c ' + stats.totalDrivers + ' t√†i x·∫ø tin t∆∞·ªüng v·ªõi m·∫°ng l∆∞·ªõi ' + stats.totalStations + ' tr·∫°m ph·ªß kh·∫Øp, EV SWAP lu√¥n s·∫µn s√†ng ƒë·ªìng h√†nh c√πng h√†nh tr√¨nh xe ƒëi·ªán c·ªßa b·∫°n.'">
                Gi·∫£i ph√°p ƒë·ªïi pin th√¥ng minh v·ªõi c√¥ng ngh·ªá ti√™n ti·∫øn v√† d·ªãch v·ª• t·ªëi nh·∫•t d√†nh cho ng∆∞·ªùi d√πng xe m√°y ƒëi·ªán.
            </p>
        </div>
        <div class="feature-grid">
            <article class="feature-card">
                <div class="feature-icon">‚ö°</div>
                <h3>Si√™u nhanh 3 ph√∫t</h3>
                <p>Ch·ªâ m·∫•t 3 ph√∫t ƒë·ªÉ thay pin, s·∫µn s√†ng ti·∫øp t·ª•c h√†nh tr√¨nh m√† kh√¥ng c·∫ßn ch·ªù s·∫°c.</p>
            </article>
            <article class="feature-card">
                <div class="feature-icon">üåê</div>
                <h3>M·∫°ng l∆∞·ªõi r·ªông kh·∫Øp</h3>
                <p>H∆°n 50 tr·∫°m ph·ªß kh·∫Øp c·∫£ n∆∞·ªõc, lu√¥n trong b√°n k√≠nh d∆∞·ªõi 5km.</p>
            </article>
            <article class="feature-card">
                <div class="feature-icon">üõ°Ô∏è</div>
                <h3>An to√†n tuy·ªát ƒë·ªëi</h3>
                <p>Pin ƒë∆∞·ª£c ki·ªÉm ƒë·ªãnh nghi√™m ng·∫∑t, ƒë·∫£m b·∫£o an to√†n cho ng∆∞·ªùi d√πng v√† ph∆∞∆°ng ti·ªán.</p>
            </article>
        </div>
    </section>

    <section class="feature-section container">
        <div class="feature-grid">
            <article class="feature-card">
                <div class="feature-icon">üí∞</div>
                <h3>Ti·∫øt ki·ªám chi ph√≠</h3>
                <p>Ch·ªâ 25.000ƒë m·ªói l·∫ßn ƒë·ªïi. Ti·∫øt ki·ªám 60% so v·ªõi xƒÉng truy·ªÅn th·ªëng.</p>
            </article>
            <article class="feature-card">
                <div class="feature-icon">üïí</div>
                <h3>Ho·∫°t ƒë·ªông 24/7</h3>
                <p>Tr·∫°m ƒë·ªïi pin ph·ª•c v·ª• kh√¥ng ng·ª´ng ngh·ªâ, h·ªó tr·ª£ m·ªçi nhu c·∫ßu di chuy·ªÉn.</p>
            </article>
            <article class="feature-card">
                <div class="feature-icon">üå±</div>
                <h3>Th√¢n thi·ªán m√¥i tr∆∞·ªùng</h3>
                <p>Gi·∫£m ph√°t th·∫£i CO<sub>2</sub>, g√≥p ph·∫ßn x√¢y d·ª±ng t∆∞∆°ng lai giao th√¥ng xanh.</p>
            </article>
        </div>
    </section>

    <section id="reports" class="demo-section container">
        <h2 class="section-title">Tr·∫°m ho·∫°t ƒë·ªông n·ªïi b·∫≠t</h2>
        <p class="section-description"
           th:text="'C√≥ ' + stats.activeStations + ' tr·∫°m ƒëang ph·ª•c v·ª•. D·ªØ li·ªáu ƒë∆∞·ª£c ƒë·ªìng b·ªô tr·ª±c ti·∫øp t·ª´ h·ªá th·ªëng EV SWAP.'">
            C√≥ 0 tr·∫°m ƒëang ph·ª•c v·ª•. D·ªØ li·ªáu ƒë∆∞·ª£c ƒë·ªìng b·ªô tr·ª±c ti·∫øp t·ª´ h·ªá th·ªëng EV SWAP.
        </p>
        <div class="demo-grid" th:if="${hasStations}">
            <div class="demo-card" th:each="station : ${highlightStations}">
                <div class="demo-icon">üìç</div>
                <h3 th:text="${station.name}">T√™n tr·∫°m</h3>
                <p class="station-meta" th:text="${station.address != null ? station.address : 'ƒê·ªãa ch·ªâ ƒëang c·∫≠p nh·∫≠t'}">ƒê·ªãa ch·ªâ</p>
                <p class="station-meta" th:if="${station.latitude != null && station.longitude != null}">
                    T·ªça ƒë·ªô:
                    <span th:text="${station.latitude}">0</span>,
                    <span th:text="${station.longitude}">0</span>
                </p>
                <p class="station-status"
                   th:text="${station.status != null ? (station.status.equalsIgnoreCase('active') ? 'ƒêang ho·∫°t ƒë·ªông' : station.status) : 'ƒêang c·∫≠p nh·∫≠t'}">
                    ƒêang ho·∫°t ƒë·ªông
                </p>
            </div>
        </div>
        <p class="empty-state" th:if="${!hasStations}">Ch∆∞a c√≥ d·ªØ li·ªáu tr·∫°m trong h·ªá th·ªëng.</p>
    </section>

    <section id="account" class="cta-section">
        <div class="container cta-inner">
            <div class="cta-content">
                <h2>S·∫µn s√†ng chuy·ªÉn ƒë·ªïi sang t∆∞∆°ng lai xanh?</h2>
                <p>Gia nh·∫≠p c·ªông ƒë·ªìng h∆°n 10,000 t√†i x·∫ø s·ª≠ d·ª•ng EV SWAP. Tr·∫£i nghi·ªám c√¥ng ngh·ªá ƒë·ªïi pin th√¥ng minh ngay h√¥m nay.</p>
            </div>
            <div class="cta-actions">
                <a th:href="@{/register}" class="btn primary">ƒêƒÉng k√Ω ngay</a>
                <a th:href="@{/login}" class="btn outline">ƒê√£ c√≥ t√†i kho·∫£n</a>
            </div>
        </div>
    </section>

    <section id="stations" class="preview-section container">
        <div class="preview-card">
            <div class="preview-header">
                <span class="brand-icon">üì∫</span>
                <h3>EV SWAP</h3>
                <p th:text="'ƒê√£ c√≥ ' + stats.totalDrivers + ' t√†i x·∫ø v·ªõi ' + stats.totalVehicles + ' ph∆∞∆°ng ti·ªán ƒë∆∞·ª£c qu·∫£n l√Ω.'">
                    H·ªá th·ªëng ƒë·ªïi pin xe m√°y ƒëi·ªán th√¥ng minh nh·∫•t Vi·ªát Nam.
                </p>
            </div>
            <ul class="preview-list">
                <li th:text="stats.activeStations + ' tr·∫°m ƒëang ho·∫°t ƒë·ªông'"></li>
                <li th:text="(stats.totalStations - stats.activeStations) > 0 ? (stats.totalStations - stats.activeStations) + ' tr·∫°m ƒëang b·∫£o tr√¨' : 'To√†n b·ªô tr·∫°m s·∫µn s√†ng ph·ª•c v·ª•'"></li>
                <li th:text="stats.activeStaff + ' nh√¢n vi√™n h·ªó tr·ª£ theo ca 24/7'"></li>
            </ul>
            <a th:if="${loggedIn}" th:href="@{/dashboard}" class="btn ghost full">Xem dashboard</a>
            <a th:if="${!loggedIn}" th:href="@{/login}" class="btn ghost full">ƒêƒÉng nh·∫≠p</a>
        </div>
        <div class="preview-card dark">
            <h3 th:text="${loggedIn} ? 'Qu·∫£n l√Ω ph∆∞∆°ng ti·ªán' : 'Gia nh·∫≠p c·ªông ƒë·ªìng EV SWAP'">H·ªó tr·ª£ ∆∞u ti√™n</h3>
            <p th:if="${loggedIn}" th:text="'B·∫°n ƒëang qu·∫£n l√Ω ' + vehicleCount + ' ph∆∞∆°ng ti·ªán. C·∫≠p nh·∫≠t th√¥ng tin ƒë·ªÉ ch√∫ng t√¥i h·ªó tr·ª£ t·ªët nh·∫•t.'">
                B·∫°n ƒëang qu·∫£n l√Ω 0 ph∆∞∆°ng ti·ªán. C·∫≠p nh·∫≠t th√¥ng tin ƒë·ªÉ ch√∫ng t√¥i h·ªó tr·ª£ t·ªët nh·∫•t.
            </p>
            <p th:if="${!loggedIn}">K√≠ch ho·∫°t t√†i kho·∫£n ƒë·ªÉ nh·∫≠n t∆∞ v·∫•n ri√™ng v√† ƒë·∫∑c quy·ªÅn chƒÉm s√≥c kh√°ch h√†ng.</p>
            <ul class="preview-list" th:if="${loggedIn}">
                <li>ƒê·ªïi pin v√† theo d√µi th·ªùi gian th·ª±c</li>
                <li>Nh·∫Øc l·ªãch b·∫£o tr√¨ pin</li>
                <li>Qu·∫£n l√Ω ho√° ƒë∆°n minh b·∫°ch</li>
            </ul>
            <ul class="preview-list" th:if="${!loggedIn}">
                <li>ƒê·ªôi ng≈© tr·ª±c 24/7</li>
                <li>H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng chi ti·∫øt</li>
                <li>∆Øu ƒë√£i d√†nh ri√™ng h·ªôi vi√™n</li>
            </ul>
            <a th:if="${loggedIn}" th:href="@{/vehicles/register(driverId=${driverId})}" class="btn primary full">Th√™m ph∆∞∆°ng ti·ªán</a>
            <a th:if="${!loggedIn}" th:href="@{/register}" class="btn primary full">Tham gia ngay</a>
        </div>
    </section>

    <section class="footer container">
        <p th:if="${dashboardMessage}" th:text="${dashboardMessage}" class="footer-message"></p>
        <p class="footer-note">¬© 2024 EV SWAP. M·∫°ng l∆∞·ªõi ƒë·ªïi pin xe m√°y ƒëi·ªán th√¥ng minh ƒë·∫ßu ti√™n t·∫°i Vi·ªát Nam.</p>
    </section>
</main>

<div class="login-modal" id="login-modal" role="dialog" aria-modal="true" aria-labelledby="login-modal-title" hidden>
    <div class="login-modal__overlay" onclick="closeLoginModal()"></div>
    <div class="login-modal__dialog">
        <button type="button" class="login-modal__close" aria-label="ƒê√≥ng" onclick="closeLoginModal()">√ó</button>
        <div class="login-modal__content">
            <div class="login-showcase">
                <span class="brand-icon">üì∫</span>
                <h3 id="login-modal-title">EV SWAP</h3>
                <p>ƒêƒÉng nh·∫≠p ƒë·ªÉ truy c·∫≠p ƒë·∫ßy ƒë·ªß c√°c ch·ª©c nƒÉng ƒë·ªïi pin th√¥ng minh.</p>
                <ul>
                    <li>Qu·∫£n l√Ω ph∆∞∆°ng ti·ªán v√† ƒë·ªïi pin</li>
                    <li>Theo d√µi l·ªãch s·ª≠ ho√° ƒë∆°n</li>
                    <li>Nh·∫≠n h·ªó tr·ª£ ∆∞u ti√™n 24/7</li>
                </ul>
            </div>
            <div class="login-form-card">
                <h4>ƒêƒÉng nh·∫≠p t√†i kho·∫£n</h4>
                <p>Nh·∫≠p th√¥ng tin ƒë·ªÉ ti·∫øp t·ª•c s·ª≠ d·ª•ng dashboard.</p>
                <form th:action="@{/login}" method="get">
                    <div class="input-group">
                        <label for="modal-email">Email</label>
                        <input id="modal-email" name="email" type="email" placeholder="example@email.com" required>
                    </div>
                    <div class="input-group">
                        <label for="modal-password">M·∫≠t kh·∫©u</label>
                        <input id="modal-password" name="password" type="password" placeholder="********" required>
                    </div>
                    <button type="submit" class="btn primary full">ƒêƒÉng nh·∫≠p</button>
                </form>
                <p class="register-hint">Ch∆∞a c√≥ t√†i kho·∫£n? <a th:href="@{/register}">ƒêƒÉng k√Ω ngay</a></p>
            </div>
        </div>
    </div>
</div>

<script>
    const loginModal = document.getElementById('login-modal');

    function openLoginModal() {
        if (loginModal) {
            loginModal.removeAttribute('hidden');
            document.body.classList.add('modal-open');
        }
    }

    function closeLoginModal() {
        if (loginModal) {
            loginModal.setAttribute('hidden', '');
            document.body.classList.remove('modal-open');
        }
    }

    window.addEventListener('keydown', function (event) {
        if (event.key === 'Escape' && !loginModal.hasAttribute('hidden')) {
            closeLoginModal();
        }
    });
</script>
</body>
</html>

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EV SWAP Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/dashboard.css}">
</head>
<body class="dashboard-body">
<div class="background-gradient"></div>
<div class="background-glow"></div>

<header class="top-nav">
    <div class="container nav-inner">
        <div class="brand">
            <!-- Logo thay cho emoji -->
            <img th:src="@{/images/logo.jpg}" src="/images/logo.jpg" alt="EV SWAP" class="brand-logo">
            <span class="brand-name">EV SWAP</span>
        </div>
        <nav class="nav-links" aria-label="Điều hướng chính">
            <a th:if="${loggedIn}" th:href="@{/dashboard}" class="nav-link-button">Tổng quan</a>
            <a th:if="${loggedIn}" th:href="@{/vehicles}" class="nav-link-button">Phương tiện</a>
            <a th:if="${loggedIn}" th:href="@{/stations}" class="nav-link-button">Tìm trạm</a>
            <a th:if="${loggedIn}" th:href="@{/feedback}" class="nav-link-button">Báo cáo</a>
            <a th:if="${loggedIn}" th:href="@{/account}" class="nav-link-button">Tài khoản</a>
            <a th:if="${loggedIn}" th:href="@{/support}" class="nav-link-button">Hỗ trợ</a>

            <button th:if="${!loggedIn}" type="button" class="nav-link-button nav-link-button--locked" data-feature="Tổng quan">Tổng quan</button>
            <button th:if="${!loggedIn}" type="button" class="nav-link-button nav-link-button--locked" data-feature="Phương tiện">Phương tiện</button>
            <button th:if="${!loggedIn}" type="button" class="nav-link-button nav-link-button--locked" data-feature="Tìm trạm">Tìm trạm</button>
            <button th:if="${!loggedIn}" type="button" class="nav-link-button nav-link-button--locked" data-feature="Báo cáo">Báo cáo</button>
            <button th:if="${!loggedIn}" type="button" class="nav-link-button nav-link-button--locked" data-feature="Tài khoản">Tài khoản</button>
            <button th:if="${!loggedIn}" type="button" class="nav-link-button nav-link-button--locked" data-feature="Hỗ trợ">Hỗ trợ</button>
        </nav>
        <div class="auth-area" th:if="${loggedIn}">
            <span class="welcome">Xin chào, <strong th:text="${driverName}">người dùng</strong>!</span>
            <form th:action="@{/logout}" method="post">
                <button class="btn ghost" type="submit">Đăng xuất</button>
            </form>
        </div>
        <div class="auth-area" th:if="${!loggedIn}">
            <a class="btn ghost" th:href="@{/login}">Đăng nhập</a>
            <a class="btn primary" th:href="@{/register}">Đăng ký</a>
        </div>
    </div>
</header>

<main>
    <div class="container">
        <p class="alert" th:if="${loginSuccess}" th:text="${loginSuccess}"></p>
    </div>

    <!-- Hero: dùng ảnh local /images/hero.jpg -->
    <section id="overview" class="hero-banner">
        <img th:src="@{/images/hero.jpg}"
             src="/images/hero.jpg"
             alt="Hình ảnh phương tiện điện hiện đại"
             class="hero-banner__image"
             loading="lazy">
    </section>

    <section class="stats-section container">
        <article class="stat-card">
            <header>
                <h3>50+</h3>
                <p>Trạm đổi pin</p>
            </header>
            <p>Phủ sóng khắp các thành phố lớn, luôn sẵn sàng phục vụ bạn mọi lúc.</p>
        </article>
        <article class="stat-card">
            <header>
                <h3>3 phút</h3>
                <p>Thời gian đổi</p>
            </header>
            <p>Quy trình tự động và an toàn, rút ngắn tối đa thời gian chờ đợi.</p>
        </article>
        <article class="stat-card">
            <header>
                <h3>24/7</h3>
                <p>Dịch vụ</p>
            </header>
            <p>Đội ngũ hỗ trợ tận tâm, đảm bảo hành trình của bạn không bị gián đoạn.</p>
        </article>
    </section>

    <section id="benefits" class="feature-section container">
        <div class="section-header">
            <span class="section-badge">Tính năng</span>
            <h2 class="section-title">Tại sao chọn EV SWAP?</h2>
            <p class="section-description">Giải pháp đổi pin thông minh với công nghệ tiên tiến và dịch vụ tối nhất dành cho người dùng xe máy điện.</p>
        </div>
        <div class="feature-grid">
            <article class="feature-card">
                <div class="feature-icon">⚡</div>
                <h3>Siêu nhanh 3 phút</h3>
                <p>Chỉ mất 3 phút để thay pin, sẵn sàng tiếp tục hành trình mà không cần chờ sạc.</p>
            </article>
            <article class="feature-card">
                <div class="feature-icon">🌐</div>
                <h3>Mạng lưới rộng khắp</h3>
                <p>Hơn 50 trạm phủ khắp cả nước, luôn trong bán kính dưới 5km.</p>
            </article>
            <article class="feature-card">
                <div class="feature-icon">🛡️</div>
                <h3>An toàn tuyệt đối</h3>
                <p>Pin được kiểm định nghiêm ngặt, đảm bảo an toàn cho người dùng và phương tiện.</p>
            </article>
        </div>
    </section>

    <section class="feature-section container">
        <div class="feature-grid">
            <article class="feature-card">
                <div class="feature-icon">💰</div>
                <h3>Tiết kiệm chi phí</h3>
                <p>Chỉ 25.000đ mỗi lần đổi. Tiết kiệm 60% so với xăng truyền thống.</p>
            </article>
            <article class="feature-card">
                <div class="feature-icon">🕒</div>
                <h3>Hoạt động 24/7</h3>
                <p>Trạm đổi pin phục vụ không ngừng nghỉ, hỗ trợ mọi nhu cầu di chuyển.</p>
            </article>
            <article class="feature-card">
                <div class="feature-icon">🌱</div>
                <h3>Thân thiện môi trường</h3>
                <p>Giảm phát thải CO<sub>2</sub>, góp phần xây dựng tương lai giao thông xanh.</p>
            </article>
        </div>
    </section>

    <section id="account" class="cta-section">
        <div class="container cta-inner">
            <div class="cta-content">
                <h2>Sẵn sàng chuyển đổi sang tương lai xanh?</h2>
                <p>Gia nhập cộng đồng hơn 10,000 tài xế sử dụng EV SWAP. Trải nghiệm công nghệ đổi pin thông minh ngay hôm nay.</p>
            </div>
            <div class="cta-actions">
                <a th:href="@{/register}" class="btn primary">Đăng ký ngay</a>
                <a th:href="@{/login}" class="btn outline">Đã có tài khoản</a>
            </div>
        </div>
    </section>

    <section id="stations" class="preview-section container">
        <div class="preview-card">
            <div class="preview-header">
                <!-- Dùng logo ở thẻ preview luôn cho đồng bộ -->
                <img th:src="@{/images/logo.jpg}" src="/images/logo.jpg" alt="EV SWAP" class="brand-logo">
                <h3>EV SWAP</h3>
                <p>Hệ thống đổi pin xe máy điện thông minh nhất Việt Nam.</p>
            </div>
            <ul class="preview-list">
                <li>Đổi pin siêu nhanh</li>
                <li>Mạng lưới rộng khắp</li>
                <li>An toàn tuyệt đối</li>
            </ul>
            <a th:href="@{/login}" class="btn ghost full">Đăng nhập</a>
        </div>
        <div class="preview-card dark">
            <h3>Hỗ trợ ưu tiên</h3>
            <p>Kích hoạt tài khoản để nhận tư vấn riêng và đặc quyền chăm sóc khách hàng.</p>
            <ul class="preview-list">
                <li>Đội ngũ trực 24/7</li>
                <li>Hướng dẫn sử dụng chi tiết</li>
                <li>Ưu đãi dành riêng hội viên</li>
            </ul>
            <a th:href="@{/register}" class="btn primary full">Tham gia ngay</a>
        </div>
    </section>

    <section class="footer container">
        <p th:if="${dashboardMessage}" th:text="${dashboardMessage}" class="footer-message"></p>
        <p class="footer-note">© 2025 EV SWAP. Mạng lưới đổi pin xe máy điện thông minh đầu tiên tại Việt Nam.</p>
    </section>
</main>

<div class="login-modal" id="login-modal" role="dialog" aria-modal="true" aria-labelledby="login-modal-title" hidden>
    <div class="login-modal__overlay" onclick="closeLoginModal()"></div>
    <div class="login-modal__dialog">
        <button type="button" class="login-modal__close" aria-label="Đóng" onclick="closeLoginModal()">×</button>
        <div class="login-modal__content">
            <div class="login-showcase">
                <!-- Logo trong modal -->
                <img th:src="@{/images/logo.jpg}" src="/images/logo.jpg" alt="EV SWAP" class="brand-logo brand-logo--showcase">
                <h3 id="login-modal-title">EV SWAP</h3>
                <p>Đăng nhập để truy cập đầy đủ các chức năng đổi pin thông minh.</p>
                <ul>
                    <li>Quản lý phương tiện và đổi pin</li>
                    <li>Theo dõi lịch sử hoá đơn</li>
                    <li>Nhận hỗ trợ ưu tiên 24/7</li>
                </ul>
            </div>
            <div class="login-form-card">
                <h4>Đăng nhập tài khoản</h4>
                <p class="login-alert">Vui lòng đăng nhập hoặc đăng kí để tiếp tục sử dụng.</p>
                <form th:action="@{/login}" method="post">
                    <div class="input-group">
                        <label for="modal-email">Email</label>
                        <input id="modal-email" name="email" type="email" placeholder="example@email.com" required>
                    </div>
                    <div class="input-group">
                        <label for="modal-password">Mật khẩu</label>
                        <input id="modal-password" name="password" type="password" placeholder="********" required>
                    </div>
                    <button type="submit" class="btn primary full">Đăng nhập</button>
                </form>
                <p class="register-hint">Chưa có tài khoản? <a th:href="@{/register}">Đăng ký ngay</a></p>
            </div>
        </div>
    </div>
</div>

<script>
    const loginModal = document.getElementById('login-modal');
    const modalEmailInput = document.getElementById('modal-email');

    function openLoginModal() {
        if (loginModal) {
            loginModal.removeAttribute('hidden');
            document.body.classList.add('modal-open');
            if (modalEmailInput) {
                modalEmailInput.focus();
            }
        }
    }

    function closeLoginModal() {
        if (loginModal) {
            loginModal.setAttribute('hidden', '');
            document.body.classList.remove('modal-open');
        }
    }

    // Gắn mở modal cho các nút bị khóa khi chưa đăng nhập
    document.querySelectorAll('.nav-link-button--locked').forEach(function (button) {
        button.addEventListener('click', function (event) {
            event.preventDefault();
            openLoginModal();
        });
    });

    window.addEventListener('keydown', function (event) {
        if (event.key === 'Escape' && !loginModal.hasAttribute('hidden')) {
            closeLoginModal();
        }
    });
</script>
</body>
</html>
